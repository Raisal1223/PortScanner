import socket
import redis

# Connect to the Redis server
r = redis.Redis(host="172.17.0.2", port=6379, db=0, password='None')

# Define the target server and ports to scan
server = "google.com"
ports = [22, 80, 443]

# Scan the server for open ports
open_ports = {}
for port in ports:
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    # sock.settimeout(5)
    result = sock.connect_ex((server, port))
    if result == 0:
        open_ports[port] = "open"
    else:
        open_ports[port] = "closed"
    sock.close()

# Save the results in a Redis hash
r.hmset("server_information", open_ports)
